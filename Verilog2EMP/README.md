Circuit file for the EMP Toolkit
=======
This directory contains the code to convert the netlist generated by TinyGarble to the circuit format used in the [EMP Toolkit](https://github.com/emp-toolkit).

### <i>This is currently going through some changes and will not work with the current version of [EMP Toolkit](https://github.com/emp-toolkit). Please checkout commit</i> `fdc750613d8fab2a8237ec186acb32cf0f6b6889` <i>for the last stable version</i>

## Circuit Format
The module structure is as follows. 
```
module _name_ ( 
  input		[K-1:0]	e_init,
  input		[L-1:0]	e_input,
  input		[M-1:0]	g_init,
  input		[N-1:0]	g_input,
  output	[P-1:0]	o
  );
  
  //description
  
endmodule 
```
`rst` is <i>asynchronous active high</i> reset. `g_init` is garbler's (Alice) initial values, `e_init` is evaluator's 
(Bob) initial values, `g_input` is garbler's inputs, `e_input` is evaluator's input, and `o` is the output port. 
`g_init` and `e_init` can only be assigned at reset. 
All the init bits from the garbler are concatenated to form a single input `g_init`. 
Similar concatenations are done for `e_init`, `g_input`,`e_input`, and `o`.
The module structure is as follows.

## Wire Index
```
0. "0"
1. "1"
2. e_init (e_init[0] is placed at wire 2, if present)
3. e_input
4. g_init
5. g_input
6. internal wires
7. o (MSB of o is the wire with the highest index)
```

## EMP Format
```
num_gate num_wire
n1 n1_0 n2 n2_0 n3

for g = 0 to num_gate-1
	<# input bit><# output bit> <index of input0 wire> <index of input1 wire> <index of output wire> <LOGIC>
endfor
```
The relations with the parameters of the Circuit Format is as follows
```
n1		= K + L
n1_0		= K
n2		= M + N
n1_0		= M
num_wire 	= 2 + n1 + n2 + num_gate
n3 		= P
```

## Usage
```
./V2EMP_Main 

  -h [ --help ]         produce help message.
  -i [ --netlist ] arg  Input netlist (verilog .v) file address.
  -o [ --emp ] arg      Output EMPCircuit file address.

```

## References
- Xiao Wang and Alex J. Malozemoff and Jonathan Katz. "EMP-toolkit: Efficient MultiParty computation toolkit.", 2016. 
- Ebrahim M. Songhori, Siam U. Hussain, Ahmad-Reza Sadeghi, Thomas Schneider
and Farinaz Koushanfar, ["TinyGarble: Highly Compressed and Scalable Sequential
Garbled Circuits."](http://esonghori.github.io/file/TinyGarble.pdf) <i>Security
and Privacy, 2015 IEEE Symposium on</i> May, 2015.

